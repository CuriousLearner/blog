<!DOCTYPE html>
<html lang="en">

<head>
            <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">


        <title>Fixing the print redirection suggestion in Python 3.7</title>

            <link href="feeds/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Sanyam Khurana Full RSS Feed" />
            <link href="feeds/feeds/{slug}.rss.xml" type="application/rss+xml" rel="alternate" title="Sanyam Khurana Categories RSS Feed" />
        <!-- Bootstrap Core CSS -->
        <link href="https://www.sanyamkhurana.com/blog/theme/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="https://www.sanyamkhurana.com/blog/theme/css/clean-blog.min.css" rel="stylesheet">

        <!-- Code highlight color scheme -->
            <link href="https://www.sanyamkhurana.com/blog/theme/css/code_blocks/darkly.css" rel="stylesheet">


        <!-- Custom Fonts -->
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->



        <meta name="description" content="If you've been following my contributions to CPython, I recently contributed an enhancement patch to Python 3.7 about producing correct...">

        <meta name="author" content="Sanyam Khurana">

        <meta name="tags" content="foss">
        <meta name="tags" content="python">
        <meta name="tags" content="cpython">

	                <meta property="og:locale" content="">
		<meta property="og:site_name" content="Sanyam Khurana">

	<meta property="og:type" content="article">
            <meta property="article:author" content="https://www.sanyamkhurana.com/blog/author/sanyam-khurana.html">
	<meta property="og:url" content="https://www.sanyamkhurana.com/blog/cpython-print-redirection-syntax-suggestion.html">
	<meta property="og:title" content="Fixing the print redirection suggestion in Python 3.7">
	<meta property="article:published_time" content="2017-08-20 20:34:00+05:30">
            <meta property="og:description" content="If you've been following my contributions to CPython, I recently contributed an enhancement patch to Python 3.7 about producing correct...">

            <meta property="og:image" content="https://www.sanyamkhurana.com/blog/theme/images/post-bg.jpg">
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@ErSanyamKhurana">
        <meta name="twitter:title" content="Fixing the print redirection suggestion in Python 3.7">

            <meta name="twitter:image" content="https://www.sanyamkhurana.com/blog/theme/images/post-bg.jpg">

            <meta name="twitter:description" content="If you've been following my contributions to CPython, I recently contributed an enhancement patch to Python 3.7 about producing correct...">
</head>

<body class="article-cpython-print-redirection-syntax-suggestion">

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://www.sanyamkhurana.com/blog/">Sanyam Khurana</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">

                            <li><a href="https://www.sanyamkhurana.com/blog/pages/about.html">About</a></li>
                            <li><a href="https://www.sanyamkhurana.com/blog/pages/contact.html">Contact</a></li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
        <header class="intro-header" style="background-image: url('https://www.sanyamkhurana.com/blog/theme/images/post-bg.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Fixing the print redirection suggestion in Python 3.7</h1>
                        <span class="meta">Posted by
                                <a href="https://www.sanyamkhurana.com/blog/author/sanyam-khurana.html">Sanyam Khurana</a>
                             on Sun 20 August 2017
                        </span>
                        
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    <!-- Post Content -->
    <article>
        <p>If you've been following my contributions to CPython, I recently contributed an enhancement patch to <cite>Python 3.7</cite> about <a class="reference external" href="contributing-cpython-enhancement.html">producing correct suggestion for built-in print function in Python 3 if the old print 2 statement style is used</a>.</p>
<p>The patch also got back-ported to <cite>Python 3.6</cite> and is now available to you folks :) Continuing the development on this new suggestion hint, the next target was to produce the correct hint if anyone uses the old Python 2 redirection syntax like:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span>
</pre></div>
<p>Here we're trying to redirect the &quot;message&quot; string on the <tt class="docutils literal">Standard Error</tt> stream in Python.</p>
<p>The current error thrown is a <tt class="docutils literal">TypeError</tt> like:</p>
<div class="highlight"><pre><span></span><span class="ne">TypeError</span><span class="p">:</span> <span class="n">unsupported</span> <span class="n">operand</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="o">&gt;&gt;</span><span class="p">:</span> <span class="s1">&#39;builtin_function_or_method&#39;</span> <span class="ow">and</span> <span class="s1">&#39;_io.TextIOWrapper&#39;</span><span class="o">.</span>
</pre></div>
<p>We also wanted to display the correct syntax in Python 3 like:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</pre></div>
<p>When I was working on the patch, we realized that till the time the check is made to throw the <tt class="docutils literal">TypeError</tt> inside the interpreter, we don't have the relevant information about data passed with the print statement available. So, we decided to throw a generic suggestion which would be a constant expression not depending upon the input from the user.  But it would be good enough to suggest some meaningful modification the user could do to fix the error.  We ended up with the following suggestion hint:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sys</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="n">unsupported</span> <span class="n">operand</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="o">&gt;&gt;</span><span class="p">:</span> <span class="s1">&#39;builtin_function_or_method&#39;</span> <span class="ow">and</span> <span class="s1">&#39;_io.TextIOWrapper&#39;</span><span class="o">.</span> <span class="n">Did</span> <span class="n">you</span> <span class="n">mean</span> <span class="s2">&quot;print(&lt;message&gt;, file=&lt;output_stream&gt;)&quot;</span><span class="err">?</span>
</pre></div>
<p>Also included some test cases to verify the new feature. <a class="reference external" href="https://github.com/python/cpython/commit/5e2eb35bbed3e84079165e576cdb50ef36e13493">Here is the full patch</a> if you want to see. The meaning of each of the methods used can be easily found from the official documentation.</p>
<p>I hope to write about my learning in more detail and also explain about different parts of the programming language in one of the future post.</p>

    </article>

        <div class="tags">
            <p>tags: <a href="https://www.sanyamkhurana.com/blog/tag/foss.html">foss</a>, <a href="https://www.sanyamkhurana.com/blog/tag/python.html">python</a>, <a href="https://www.sanyamkhurana.com/blog/tag/cpython.html">cpython</a></p>
        </div>

    <hr>

        <div class="comments">
            <h2>Comments !</h2>
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'curiouslearner';
                var disqus_identifier = 'cpython-print-redirection-syntax-suggestion.html';
                var disqus_url = 'https://www.sanyamkhurana.com/blog/cpython-print-redirection-syntax-suggestion.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//curiouslearner.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                            <li>
                                <a href="https://twitter.com/ErSanyamKhurana">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/CuriousLearner">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://facebook.com/CuriousLearner">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="mailto:sanyam@sanyamkhurana.com">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://www.sanyamkhurana.com/blog/feeds/all.rss.xml">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-feed fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                    </ul>
<p class="copyright text-muted">
    Blog powered by <a href="http://getpelican.com">Pelican</a>,
    which takes great advantage of <a href="http://python.org">Python</a>. <br />        &copy;  Sanyam Khurana
</p>                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="https://www.sanyamkhurana.com/blog/theme/js/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="https://www.sanyamkhurana.com/blog/theme/js/bootstrap.min.js"></script>

        <!-- Custom Theme JavaScript -->
        <script src="https://www.sanyamkhurana.com/blog/theme/js/clean-blog.min.js"></script>

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-61049901-1', 'auto');
    ga('send', 'pageview');
</script>
<script type="text/javascript">
    var disqus_shortname = 'curiouslearner';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>

</html>